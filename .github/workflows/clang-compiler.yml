name: Building new Clang

on: 
  push:
    branches:
      - clang/13.x
      - clang/14.x
  schedule:
    - cron: '30 1 * * SUN'

env:
  GIT_SECRET: ${{ secrets.GIT_SECRET }}
  BOT_TOKEN: ${{ secrets.BOT_TOKEN }}

jobs:
  build:

    runs-on: ubuntu-latest

    container: 
      image: zycromerz/tcdocker:v1

    steps:
    - uses: actions/checkout@v2
    - name: Build TC
      run: |
        export DEBIAN_FRONTEND=noninteractive
        export PATH=/usr/bin/core_perl:$PATH
        cp -af kernel/build-mod.sh kernel/build.sh
        bash ci.sh deps
        bash clang-builder.sh 14 gi
